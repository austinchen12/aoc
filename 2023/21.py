from copy import deepcopy


data = """...................................................................................................................................
..#.......#.#.##...........#...#..................#......................#.......#.......#............#...............#.....#...#..
................#....#.#.....#.#..#.#..#.........#.....................#......................#......#....#..........#.............
..#.##.....................#......##..#...##.#............................#.....#..............#..................#..#......#......
.....#.#.....#...#........#............#.#.#..#.#...#.........................................##......#..........#.#..##...........
.....#....##.........#.......##............##....#.............................#.........#.....#....#.#....#...........#.##........
...........#..#...#...........#.....##................#.........#..#...................#.#..#.....#................................
..#.....#....#....#....#......#.#.............................................###.#.......#....#..........#.#....#.....#...........
....#........................#............#.......#...............#..#.......#..........#.........#....#......#..##.........#......
..........#...#..........#..#............##.........#...........#...............................#.........#........#........#......
....#............#.#...........#.............#..#..............................##.#....#...#.#.#.#.#........#......#..#............
....#..#...#.#....#.#.##..#...................##..#........#.##....................#............#......#........#...#..............
......#.....#...##...#...#......##.....#.....#.#...............#....................#.#......#.............#..........#.........#..
......#....#..#...........##...#.#.#.#.#......##...........#.......#.....##.............#.#..##...##....................#.......#..
......................................#.#......#.......#....#...#.#..#...#............#..#........####......#....##................
..#........#........#.............#....................#.......#....#.....#................#...................#..........#........
..................#.....#.#.#....#......#.....................#............#...............#..#......#...#..##......#............#.
...#........#....#......#............................#.......#....#........#.#............................#..#....#......##........
..#..........#...#..................#......................#......#........#.............#....#..##.#......##......##.#............
...........#..........#......#..#...#.#...........#.......#.....#.....#..#...............#..............#...#.....#.##.......#.....
.#......#..#....#..................................................#..#......#.........................#.......#.....#.....#.....#.
.....##..................#............................#...#........#..#....#.#..............#.....................##.......#..##...
.........#...#......#.....###..........#...............#.......#..................................#.........##....#.......#........
....#........#.................#..............#.#......#...##...#....#...#.....#...................#....#...#.....#....#.#.........
.....#....##....#.............#...#..........................#..................#.................#..........#..............##...#.
....#.#..#....#.................#............................#......#.#................................#..##......##.....#.........
......#.................#........#.........#......##....#...#.#........#...#.....#.....................##........#..#..#...........
..........#.#.......#......#.....#..................##.......#........#.....##....#.............#.................#.#..#...........
.#.#....##.#.#.......#...................##....#...#..........#.........#.#..##.#.......#........#....#....#.#..........##....#....
...............#......#...#..............###......#.............#....#...##........#.................#....#.................##.#...
.......#....#.......#.....##.#................#...........#....................#.....##...##.........#....................##....#..
.................#.....#........................#........#.....#........#...#......#................#............................#.
..........#.................#........#..#.....................#...........##.#..............#..................#.................#.
.#.#.#................................#...#.#...#.........#...#.....#...........#..........#.#........#.#.#..........#.....#.......
.#..#...#..#...............#.................#...##...#........#........#....####......#....#.............#..#...#.............#.#.
............##........#...............#.#......................#...#..#...##..##..........#...#.........#..........##.......#......
.........#.#.#...#......#.....................##...............#..#.###........#............#..#......................#......##....
.#........##.......#.............#.#..........#..#........#..#.#.................................#..................#......#.#.....
..##...#....#..........................#...#.#.#.........#..#............#.......#....#..............................#....#........
......#.....##....#...................#...................#........#...#....#...........#..#.....#.................#.#..#.......##.
....##...#......................#.##..#....#...#.....#..................#..#...........#.....#................#...##...........##..
...............##...............#.................#.......##..........................#...#.#.........#........#........#......#...
.##....#....#...#...........#.....##....#..............#...#.........#...#.....##.....#........##.#.#...................#.......#..
.#............................#.....#...#....#.#.....#.....#.###.............#...............................................#..#..
..........#..................#...#......#...............#.#.......#............#..........#....#.................#....#.......#....
.#..#....#...#....................#......#........#.......#...#.#........#.#..........#.............#..##...........#..#...........
....#......#..................#.......#.......###..#.#.#...........#.#............#................#.....#...........##..#.##..#...
.......#.#.#...................#.##...........#.........#...#............#.....##....#..........#.....#.#.............#.#...#......
............#........##....#...........#.............................#.#.#....#..#......#.................#..........#......#.#....
.....##.#.........................#.#...##.#..#....#..........#..........#............#.......#..##.....##.##..............#.......
..#..#......................................#.......#.#..#.#.........#.....#...............#.....................................#.
......#........................#.......#.#............................#..#..#.......#......#.....#............#.#................#.
...###.#.........#..##......#............#.............###......#....#....##...................##...#..#.#....#.............#.#.#..
..##....#...........#.............#..#..#.#..........#..............#...#........#..##..#.........................#.......#........
.#.....#.............##.....#.....###.#.#..#.......#......#..#........#..............#.#....#.....................#...........#....
....#.........................#....##......#..#......#.#.....#.#.....#.................#.................#.........#...............
.#............#.........#........#.#.#.....#.....#...#.....#......#......#...............#.#.........#.............................
................##...#...#......#....#....#.........##.............#.......#.....#.......................#..###..#...##............
...........#.#..............#..#.......#....#.#.....#..............................#..##....................#.#......#.............
..................#....................#............................##.#..#.#..........#..................#............#...........
.............#.....#.......##...#..#........#.................##......#......#.#..............#..........#........#.#.#............
...........................#....##...#.###...........#.#..........#.............#.....#.#....#.....#....#..........#...............
.............#........##........#.#.#..##....#......#.............#.#....#.#.#...#...#....#.#..#.......#...........##..#...........
......#..#.....#........##.....#......#......#.#....#.#..#...#.........#.........#..............#..........###.....................
.............#..........#..#...####..........#......#..#....#.........#..##............##.....#..#.....##.#......#.#....#..#.#.....
.................................................................S.................................................................
.....................#.....#.#........##......#......##..#..#.......#.##..#...........................#..#.........................
......................#.#..........##....................#.................#......#..#.....................##.....#.......#........
................#..........#...#.....................#....#..........#.##.....##........#......#........##....#..........##........
.........##...#.#..#.....#.#...#.#................#.........#.......#..##..#.....#...#...##....#...#............#....##............
...........................#..#..#...#..#...##..................................................##.........##.#...#................
............#..#.........#........#.......#......#...#......##.##.................#.#........##.#....#....#.#...#....#.............
...........#..#.....#..#..#......#.#..#............#............#.........#..#.....#..#........#..............##.......#.......##..
...................#....##...........#.#......#.......##..#..#.#.....#...#...#.##..............#.##....#....#.#.....#.........#....
..................#..#....#......#.#...........#...#.......#........#...#......#...........#.....................#.#.............#.
................#...........#.............#.#.....#.........................##.#....#..#..........#.#...#....#................##.#.
......##........#.#......#..........#..........#..........................#...#..........###.#..............................##.....
.....#..............#........#.....#.#..#....#........##........#..#......#......#......#..#......#......##...................#....
.#................#.....#...........#.#.........#.#.....#.##.............#...........#.#.#....##.#..........#...............#.#..#.
..#..#.............#...............#....#..........#..#.....#...#...............##.....#...#............#.#...................#....
......#............#.....#.................#..............##.#......##............#....#..#.#..#.#.#.............................#.
...#..................##..........#..........#...#.................#.......#.....#...#...................#..................#.#....
.#....##....................#...#...#.........#.#....#...#.#.......#..##..#.#....#........##.#....##......#..........#...#....#..#.
....#.........#............#..#.....#.#.....#.#..#.....#................#..........#.....##...........................##...........
.#............................#...............#...#.#.........#.....#...#..........#...#.......##..#..................##.##....#...
.......#..................#.#.............#.......#....#............................#...................#.#........................
.........#........................####......#......##...##............#.....#...#...##.......#.....#.............#.##.#............
..#..#.##......#..........#..............#............#...................##...................#..#.....#.......#.....#...#...##...
....#..#...........................#.........#...#.........#.#.....#.............#.......#............#.................###.#....#.
...#.......#.#.......................##....#.......................#............#......#.....#..#....#..........#.......#..........
.......#.........##.#................#.........#.#..#.........#.....#.#...............#.#....#....#............#.....#.............
..................#.#.......................#................##......#...............#......................#..#.#.#..........##...
......##.......#.......#............#.....#........#.....##....#.....#.............#.#....#.....#.............#......#.............
...#.........#.....#...............#.........#.....#..........#...#.........#....#.#.......###..#.#..............#.................
.........#....##.#...#............#.....................#...........##......#..#..##......#.................#..#.##................
.........#.........#...##..............#.#...#..###........#.#......#...#..#............#.......#.............#.....#.......#....#.
.....................#...#..........#.#............#...#.#.##..##..........#..#........#.......#........#.......#..#.....#.#.....#.
....#..........#....................#...............................#.##.##.......###.........#........#....#.................####.
..........#...#.............##..................#..#....#............#...................#..#.............#.......#...#.......#....
.#....#..##......#.#.##.....#.............................##.#............#.#..............#.........#.................#......#....
..#.........#.....#........#................#...#...................#..............#..#............#...#...#...................#...
....#..#..#..#...........#................#......#...#......#.....#........#...#...##.#..............#........#.#......#..#..#.#...
......##..#..#..............##...........#.#...#............#...#.#.....#.#.....#.......##...............#.#.......................
.......#.........#.........#..............#...#......................#....#....#........#.......#.........#......#.................
...#..#.........#...#...#........#...............#............#....###.#.#.........#...............#................#.......#....#.
.......#.....#........#..........#...............................................#..#.#...................#.........#..#...........
................#..#....#..#......................##...............##...#.##...#..................#.....#.......#..................
.#......#...#...............#.........................#...#.............#.....#............................#.................#..#..
.................##....##........................#.......#.#...........#......................##.......#.............#...#..#......
.#..........#....#................##....#.............#.......#...#...#......#...#.................#....#....................#...#.
..................##..#.#.##..#.#...........................#.................##..........#.....................#..........#....#..
....................#...#............#..#................#...#.#...........#..#............#......##....#.....##..............#....
.#..#......#........#.........#......#..#................#.#...#..#.#......#.............#.#.....#....###...#.#....##..............
....#......#.#..#................#.#...#................#...#.......#.#.#..............#......................#..#.....#........#..
........#.............#...##.#.#...#......#................#........#...#...............#.#.......#........##.#...#.......#......#.
.........................##..#......#.#.....#.........##....#............#..........#.............#......#....#............#...#...
...#.....#..#.....#.........#..#..#.##.................................#.............#......##............#....#..#......#.......#.
..#...#....#.#.#...#...#..#...#............##.............................#..................##..............#...................#.
..#..#.....##.............#...........#...#...#.#..........#.......#....#...........#........#........##.......#.......#...........
........#.#...#...........#..###...........#.....#................#.................##.........#.....#....#....#.....#.#.......#.#.
...#......#..............#....#...##...#..###.....#.........#.......#....................#...#.........##..........#..#..........#.
.....#.#....................#........#....###.#..............####....................................#.#...#..#...........#....#...
...#.#...##...#.........#...#............#.....#...#............#...#.........#..#...........................#..#............#.....
.#...#.#..###..................#...#..........#......#........#.#................#.......................##.###.....#.#............
.....................#.#..#.....#.#..#............................................#..#.......#...#.#.........##.....#..............
...#............##.......#...#.##..#........##...#....#....................#.#......#.#....................##.#...#..#....#..#.....
........#....#..........................#...#...........................................#...#..............#..........##.......#...
..............#..#............##......#..#.#......#....#.........................#.....#..#..#...#..........##.....#..........#....
..........#....##........#....#..#....#.................#.................#.#...............#.......#....#...#...............#..#..
...............#..#......#..........#...#......#......##.#..............#.#..........#...#......#..#....#................#..#...#..
...................................................................................................................................""".split('\n')


data_arr = []
for i, line in enumerate(data):
    data_arr.append(list(line))
    if 'S' in line:
        start = (i, line.index('S'))
        data_arr[i][line.index('S')] = '.'
data = data_arr
DIRS = [(0, -1), (-1, 0), (0, 1), (1, 0)]
#####
def run():
    queue, count = [set([start])], 0
    while queue:
        level = queue.pop(0)
        if count == 64:
            return level
        temp = set()
        for r, c in level:
            for dr, dc in DIRS:
                nr, nc = r + dr, c + dc
                if not (0 <= nr < len(data) and 0 <= nc < len(data[0])):
                    continue

                if data[nr][nc] == '.':
                    temp.add((nr, nc))
        if temp:
            queue.append(temp)
        count += 1
        
    return level
print(len(run()))

#####
import math, fractions
def run2(val):
    queue, count = [set([start])], 0
    seen, reachable = set(), set()
    while queue:
        level = queue.pop(0)
        if count == val + 1:
            return len(reachable)
        temp = set()
        for r, c in level:
            seen.add((r, c))
            if count % 2 == val % 2:
                reachable.add((r, c))

            for dr, dc in DIRS:
                nr, nc = (r + dr), (c + dc)
                if (nr, nc) in seen:
                    continue

                if data[nr % len(data)][nc % len(data[0])] == '.':
                    temp.add((r + dr, c + dc))
        queue.append(temp)
        count += 1
    assert False
def lagrange(x0, x, y):
    a = (
        fractions.Fraction(
        math.prod(x0 - xj for xj in x if xj != xi),
        math.prod(xi - xj for xj in x if xj != xi),
        )
        for xi in x
        )
    return sum(ai * yi for ai, yi in zip(a, y))
x = [i * len(data) // 2 for i in range(1, 2 * (2 + 1), 2)]
y = [run2(xi) for xi in x] 
print(lagrange(26501365, x, y))