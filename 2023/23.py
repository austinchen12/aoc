data = """#.###########################################################################################################################################
#.....#...#...#.............#.....#...#.....#...###...###...#.........#...#...#...#...#...#...#...#####...#.........#.....###...#...........#
#####.#.#.#.#.#.###########.#.###.#.#.#.###.#.#.###.#.###.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#######.#.###.###.#.#.#########.#
#.....#.#.#.#.#.#...........#...#.#.#...#...#.#...#.#...#.#.#.....#...#.#...#...#...#.#.#.#.#.#.#.....#.#.#.......#.#.#...#...#.#.#.........#
#.#####.#.#.#.#.#.#############.#.#.#####.###.###.#.###.#.#.#####.#.###.#############.#.#.#.#.#.#####.#.#.#######.#.#.#.###.###.#.#.#########
#...#...#.#.#.#.#...###...#...#.#...#.....###...#.#.#...#.#...#...#...#.............#.#.#.#.#.#.#.....#.#.#...#...#...#.###...#...#...#...###
###.#.###.#.#.#.###v###.#.#.#.#.#####.#########.#.#.#.###.###.#.#####.#############.#.#.#.#.#.#.#.#####.#.#.#.#.#######.#####.#######.#.#.###
###.#.#...#.#.#...#.>.#.#.#.#.#.....#.#...#####.#.#.#.#...#...#...#...#...###...#...#...#...#.#.#.#####.#.#.#.#...#...#...#...#.......#.#.###
###.#.#.###.#.###.#v#.#.#.#.#.#####.#.#.#.#####.#.#.#.#.###.#####.#.###.#.###.#.#.###########.#.#.#####.#.#.#.###.#.#.###.#.###.#######.#.###
#...#.#.....#.....#.#.#.#.#.#.#...#.#.#.#.>.>.#.#.#.#.#.#...#####.#...#.#.#...#.#.......#.....#.#...#...#.#.#.#...#.#.....#...#.###...#.#.###
#.###.#############.#.#.#.#.#.#.#.#.#.#.###v#.#.#.#.#.#.#.#######.###.#.#.#.###.#######.#.#####.###.#.###.#.#.#.###.#########.#.###.#.#.#.###
#.#...#.........#...#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.>.>.#.#...#.#.#...#.#...#...#.#...#.#...#...#.#.#.#...#.#...###...#.....#...#...#
#.#.###.#######.#.#######.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#v#.#.#.###.#.###.#.#.#.#.###.#.#.#.#.#####.#.#.#.###.#.#.#.###.###############.#
#...#...#.....#...#...###.#.#.#.#...#...#...#.#.#.#.#.#.#...#.#...#.....#.#...#...#.#...#.#.#...#.#.>.>.#.#.#...#.#.#.#.#...#.............#.#
#####.###.###.#####.#.###.#.#.#.###########.#.#.#.#.#.#.#####.###########.#.#######.###.#.#.#####.#.#v###.#.###.#.#.#.#.#.###.###########.#.#
#...#.....###.#.....#...#.#.#.#...#.........#...#.#.#.#...#...#...........#.....#...#...#.#.....#...#.###...###.#.#.#.#.#.#...#.........#.#.#
#.#.#########.#.#######.#.#.#.###.#.#############.#.#.###.#.###.###############.#.###.###.#####.#####.#########.#.#.#.#.#.#.###.#######.#.#.#
#.#.#.........#.#.......#...#...#.#.#.....#...#...#.#...#.#...#.....#...#...>.>.#.#...###...#...###...#...#####.#.#.#.#...#.....#.......#...#
#.#.#.#########.#.#############.#.#.#.###.#.#.#.###.###.#.###.#####.#.#.#.###v###.#.#######.#.#####.###.#.#####.#.#.#.###########.###########
#.#...#.........#...........###...#...###...#.#.#...#...#.###...###...#.#.#...###...#######.#.#.....#...#.....#.#.#.#.#...###...#.........###
#.#####.###################.#################.#.#.###.###.#####.#######.#.#.###############.#.#.#####.#######.#.#.#.#.#.#.###.#.#########.###
#.......###...#.....#...#...#...............#.#.#...#.....#...#.....###...#...........#.....#.#.......#.......#...#.#.#.#.....#.........#...#
###########.#.#.###.#.#.#.###.#############.#.#.###.#######.#.#####.#################.#.#####.#########.###########.#.#.###############.###.#
#.....#.....#.#...#.#.#.#...#.............#...#.....#.......#.....#.......#...........#.......#...#.....###.......#.#.#...............#.....#
#.###.#.#####.###.#.#.#.###.#############.###########.###########.#######.#.###################.#.#.#######.#####.#.#.###############.#######
#...#.#.....#.....#.#.#.#...#...#####...#.......#.....#.........#.#...#...#.............#.......#.#.........#...#.#...#.........#.....###...#
###.#.#####.#######.#.#.#.###.#.#####.#.#######.#.#####.#######.#.#.#.#.###############.#.#######.###########.#.#.#####.#######.#.#######.#.#
#...#.#...#.......#...#...###.#.......#.........#...#...#.......#...#...#...#.....#.....#.......#.....#...#...#...#...#...#...#...#####...#.#
#.###.#.#.#######.###########.#####################.#.###.###############.#.#.###.#.###########.#####.#.#.#.#######.#.###.#.#.#########.###.#
#...#.#.#.#.....#...#.......#.....................#...###...#...#...###...#...###...#...###...#...#...#.#...#.....#.#...#...#...........#...#
###.#.#.#.#.###.###.#.#####.#####################.#########.#.#.#.#.###.#############.#.###.#.###.#.###v#####.###.#.###.#################.###
#...#...#...###...#...#.....#...............#.....#...#...#...#.#.#...#.........#.....#.#...#.#...#...>.>...#...#.#...#...................###
#.###############.#####.#####.#############.#.#####.#.#.#.#####v#.###.#########.#.#####.#.###.#.#######v###.###.#.###.#######################
#.#...#.........#.......#...#.....#.......#...###...#...#.###.>.>.#...#...#.....#.....#...#...#.....###.#...#...#.###.......................#
#.#.#.#.#######.#########.#.#####.#.#####.#######.#######.###.#v###.###.#.#.#########.#####.#######.###.#.###.###.#########################.#
#.#.#.#.#.......#...###...#.#...#...#...#...#...#.......#...#.#...#...#.#.#.......###...###...#.....#...#...#...#.#...###...#...#...........#
#.#.#.#.#.#######.#.###.###.#.#.#####.#.###.#.#.#######.###.#.###.###.#.#.#######.#####.#####.#.#####.#####.###.#.#.#.###.#.#v#.#.###########
#...#...#...###...#...#...#.#.#...#...#.....#.#.###...#...#.#.#...###.#.#.#.......#...#...###.#...###.....#...#.#.#.#.#...#.>.#.#...........#
###########v###.#####.###.#.#.###.#.#########.#.###.#.###.#.#.#.#####.#.#.#.#######.#.###.###.###.#######.###.#.#.#.#.#.#####v#.###########.#
#.....#...#.>...#.....#...#.#.#...#.........#.#.#...#.....#.#.#.....#.#.#.#...#...#.#...#...#...#.#.......#...#.#...#.#...#...#.............#
#.###.#.#.#v#####.#####.###.#.#.###########.#.#.#.#########.#.#####.#.#.#.###.#.#.#.###.###.###.#.#.#######.###.#####.###.#.#################
#...#...#...###...#...#...#.#.#.#...#...#...#.#.#.........#.#...#...#.#.#...#.#.#...###...#.###...#.#...###...#.....#.....#.............#...#
###.###########.###.#.###.#.#.#.#.#.#.#.#v###.#.#########.#.###.#.###.#.###.#v#.#########.#.#######.#.#.#####.#####.###################.#.#.#
#...#.........#...#.#.#...#.#.#.#.#...#.>.>.#.#.#...#...#.#...#.#...#.#...#.>.>.#.....#...#...#...#...#...###.....#.#...................#.#.#
#.###.#######.###.#.#.#.###.#.#.#.#######v#.#.#.#.#.#.#.#.###.#.###.#.###.###v###.###.#.#####.#.#.#######.#######.#.#.###################.#.#
#.....#.....#.###.#.#...#...#.#.#.#...###.#.#.#.#.#.#.#.#...#...#...#.....###...#.#...#.....#.#.#.........#...###...#...........#...#...#.#.#
#######.###.#.###.#.#####.###.#.#.#.#.###.#.#.#.#.#.#.#.###.#####.#############.#.#.#######.#.#.###########.#.#################.#.#.#.#.#.#.#
#.......###...#...#.....#.....#...#.#.#...#.#.#.#.#.#.#.#...#...#.......#.....#...#...#...#...#.............#.....#.............#.#...#...#.#
#.#############.#######.###########.#.#.###.#.#.#.#.#.#.#.###.#.#######.#.###.#######.#.#.#######################.#.#############.#########.#
#.......###...#.....#...#...........#.#...#...#...#...#...#...#.........#...#.#.......#.#.###.....#...............#.#...#...#...#.#.......#.#
#######.###.#.#####.#.###.###########.###.#################.###############.#.#.#######.#.###.###.#.###############.#.#.#.#.#.#.#.#.#####.#.#
#.......#...#...#...#...#.....#.....#.....#.....#...###.....#...........###.#.#...###...#.#...#...#.....#.....#...#.#.#...#...#...#.....#.#.#
#.#######.#####.#.#####.#####.#.###.#######.###.#.#.###.#####.#########.###.#.###.###.###.#.###.#######v#.###.#.#.#.#.#################.#.#.#
#.#.......#...#.#.......###...#.#...#...###...#.#.#...#.......#.........#...#...#...#.#...#...#.#...#.>.>.#...#.#.#...#...#...#...#.....#...#
#.#.#######.#.#.###########.###.#.###.#.#####.#.#.###.#########.#########.#####.###.#.#.#####.#.#.#.#.#v###.###.#.#####.#.#.#.#.#.#.#########
#...#...#...#...#.........#.#...#.....#...###.#.#...#...#.....#.........#...#...###...#.#...#.#...#...#...#.....#...#...#...#.#.#.#.###...###
#####.#.#.#######.#######.#.#.###########.###.#.###.###.#.###.#########.###.#.#########.#.#.#.###########.#########.#.#######.#.#.#.###.#.###
#.....#.#.......#.......#.#...#...#.......#...#.#...#...#...#.#...#...#...#.#...#...#...#.#.#.......###...###.......#.......#...#.#.....#...#
#.#####.#######.#######.#.#####.#.#.#######.###.#.###.#####.#.#.#.#.#.###.#.###.#.#.#.###.#.#######.###.#####.#############.#####.#########.#
#.#...#.........#.....#.#...#...#...###...#.#...#.#...#...#.#.#.#.#.#.....#.#...#.#.#.###.#.#...#...#...#...#...........###.....#.#...#.....#
#.#.#.###########.###.#.###.#.#########.#.#.#.###.#.###.#.#.#.#.#.#v#######.#.###.#.#v###.#.#.#.#.###.###.#.###########.#######.#.#.#.#.#####
#...#.......#...#...#.#.#...#.......#...#.#.#.#...#...#.#.#.#...#.>.>.#...#.#...#.#.>.>.#.#...#...###...#.#.#...#.....#.#.......#.#.#.#.....#
###########.#.#.###.#.#.#.#########.#.###.#.#.#.#####.#.#.#.#######v#.#.#.#.###.#.###v#.#.#############.#.#.#.#.#.###.#.#.#######.#.#.#####.#
#...........#.#.#...#.#.#...#.......#...#.#.#.#.....#...#.#.#.......#.#.#.#.###...###.#.#.....#...#.....#.#...#.#...#...#.......#...#.......#
#.###########.#.#.###.#.###.#.#########.#.#.#.#####.#####.#.#.#######.#.#.#.#########.#.#####.#.#.#.#####.#####.###.###########.#############
#.#...#...###.#.#...#.#.#...#.......#...#.#.#.#...#...#...#.#.....###...#...#####...#.#.#.....#.#.#.....#.#.....#...###...#...#...#...#.....#
#.#.#v#.#.###.#.###.#.#.#.#########v#.###.#.#.#.#.###.#.###.#####.###############.#.#.#.#.#####.#.#####.#.#.#####.#####.#.#v#.###.#.#.#.###.#
#.#.#.>.#.#...#.#...#.#.#.#...#...>.>.###...#.#.#.....#.#...#.....#...#...#...#...#.#.#.#...#...#.....#...#.....#...#...#.>.#.....#.#...#...#
#.#.#v###.#.###.#.###.#.#.#.#.#.###v#########.#.#######.#.###.#####.#.#.#.#.#.#.###.#.#.###.#.#######.#########.###.#.#####v#######.#####.###
#...#...#...###...#...#.#.#.#.#.###.........#...#...###...###.......#...#.#.#...###...#.....#...#.....###...#...###...#.....#.....#.#...#...#
#######.###########.###.#.#.#.#.###########.#####.#.#####################.#.###################.#.#######.#.#.#########.#####.###.#.#.#.###.#
###...#.........#...#...#.#.#.#.#.........#.#...#.#.#...#...#...#.........#.........#...#.....#.#.....#...#.#.......###.....#.#...#.#.#.....#
###.#.#########.#.###.###.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#.#################.#.#.#.###.#.#####.#.###.#######.#######.#.#.###.#.#######
#...#...........#.....###...#...#...#...#...#.#.#.#.#.#.#.#.#.#.#.........#.........#.#.#...#.#.#.....#...#.#...#...#...###...#.....#...#...#
#.#################################.#.#.#####.#.#.#.#.#.#.#.#.#.#########.#.#########.#.###.#.#.#.#######.#.#.#.#v###.#.###############.#.#.#
#...................#.....#...#.....#.#...###.#.#.#.#.#.#.#.#.#.#.........#...........#.###.#...#...#...#.#...#.>.>.#.#.#...###.......#...#.#
###################.#.###.#.#.#.#####.###.###.#.#.#.#.#.#.#.#.#.#v#####################.###.#######.#.#.#.#######v#.#.#.#.#.###.#####.#####.#
#.......#...........#...#...#...#...#.#...#...#.#.#.#.#...#.#.#.>.>.......#.............#...#.....#...#...#.....#.#.#.#.#.#...#.....#.#.....#
#.#####.#.#############.#########.#.#.#.###.###.#.#.#.#####.#.###v#######.#.#############.###.###.#########.###.#.#.#.#.#.###.#####.#.#.#####
#.#...#.#.......#...###.........#.#.#.#...#...#...#.#.....#.#.###...#.....#...........###.....#...###.....#...#.#.#.#.#.#.#...###...#.#.....#
#.#.#.#.#######.#.#.###########.#.#.#.###.###.#####.#####.#.#.#####.#.###############.#########.#####.###.###.#.#.#.#.#.#.#.#####.###.#####.#
#.#.#.#.........#.#...#.....#...#.#...#...#...#.....#.....#.#.#.....#...###...#.....#.#.........#.....#...#...#.#.#.#.#.#.#.#...#.###.......#
#.#.#.###########.###.#.###.#.###.#####.###.###.#####.#####.#.#.#######.###.#.#.###.#.#.#########.#####.###.###.#.#.#.#.#.#.#.#.#.###########
#...#.#.........#.#...#...#.#...#.....#...#...#.....#.#...#.#.#.....#...#...#.#.###...#...........#.....#...###...#.#.#.#.#...#.#...#.......#
#####.#.#######.#.#.#####.#.###v#####.###.###.#####.#.#.#.#.#.#####.#.###.###.#.###################.#####.#########.#.#.#.#####.###.#.#####.#
#.....#...#.....#.#.#.....#.#.>.>.....###.....###...#...#.#.#.#.....#...#.#...#...#...#.............###...#...#.....#.#...#.....#...#.#.....#
#.#######.#v#####.#.#.#####.#.#v#################.#######.#.#.#.#######.#.#.#####.#.#.#.###############.###.#.#.#####.#####.#####v###.#.#####
#.........#.>.#...#.#.###...#.#...#...#.........#.......#.#...#.....###...#...#...#.#.#.............#...###.#.#.......###...#...>.#...#.....#
###########v#.#.###.#.###.###.###.#.#.#.#######.#######.#.#########.#########.#v###.#.#############.#.#####.#.###########.###.###v#.#######.#
#.........#.#...#...#...#...#.###.#.#...#.....#.....#...#...#...###...#...###.>.>.#.#...#...#...#...#.......#.#.....#...#...#.###...#...#...#
#.#######.#.#####.#####.###.#.###.#.#####.###.#####.#.#####.#.#.#####.#.#.#####v#.#.###.#.#.#.#.#.###########.#.###.#.#.###.#.#######.#.#.###
#.......#.#.....#.#...#...#.#.#...#.#.....###...#...#...#...#.#.......#.#.......#.#.###.#.#.#.#...#...#.......#.#...#.#.#...#...#.....#...###
#######.#.#####.#.#.#.###.#.#.#.###.#.#########.#.#####.#.###.#########.#########.#.###.#.#.#.#####.#.#.#######.#.###.#.#.#####.#.###########
#.......#.......#.#.#.#...#...#.....#.......###...#####...###.........#.........#.#.###...#...#.....#...#...#...#...#.#.#...#...#...........#
#.###############.#.#.#.###################.#########################.#########.#.#.###########.#########.#.#.#####.#.#.###.#.#############.#
#.............###...#...###...#.............#...#...###...#...#.......###.......#...#.........#.........#.#.#...#...#.#.###...###...........#
#############.#############.#.#.#############.#.#.#.###.#.#.#.#.#########.###########.#######.#########.#.#.###.#.###.#.#########.###########
###...#.......#.....#.....#.#.#.#...........#.#.#.#.#...#...#.#.....#...#...........#.....#...#.......#...#...#.#.#...#.#.......#...........#
###.#.#.#######.###.#.###.#.#.#.#.#########.#.#.#.#.#.#######.#####.#.#.###########.#####.#.###.#####.#######.#.#.#.###.#.#####.###########.#
#...#.#.....###.#...#.#...#.#.#...#.........#.#.#.#.#.#.......###...#.#.#.....#.....#.....#...#.....#.#.......#.#.#.#...#...#...###...#.....#
#.###.#####v###.#.###.#.###.#.#####.#########.#.#.#.#.#.#########.###.#.#.###.#.#####.#######.#####.#.#.#######.#.#.#.#####.#.#####v#.#.#####
#...#.....#.>.#.#.#...#.#...#.#...#...###...#.#.#.#.#.#.#...#...#...#.#.#...#...#...#.....#...#...#.#...#...#...#.#.#.....#.#...#.>.#.#.....#
###.#####.#v#.#.#.#.###.#.###.#.#.###.###.#.#.#.#.#.#.#.#.#.#.#.###v#.#.###.#####.#.#####.#.###.#.#v#####.#.#.###.#.#####.#.###.#.#v#.#####.#
#...#...#...#.#.#...#...#...#.#.#.#...#...#.#.#...#.#.#.#.#.#.#.#.>.>.#...#...###.#.#...#.#.....#.>.>.#...#...#...#.#.....#...#.#.#.#.....#.#
#.###.#.#####.#.#####.#####.#.#.#.#.###.###.#.#####.#.#.#.#.#.#.#.#v#####.###.###.#.#.#.#.#########v#.#.#######.###.#.#######.#.#.#.#####.#.#
#.....#.....#.#...#...#...#.#...#.#...#...#.#.....#.#.#.#.#...#...#.#.....#...#...#.#.#...###...#...#...#...###...#.#...#...#.#.#.#...###...#
###########.#.###.#.###.#.#.#####.###.###.#.#####.#.#.#.#.#########.#.#####.###.###.#.#######.#.#.#######.#.#####.#.###.#.#.#.#.#.###.#######
#...........#.....#...#.#.#.#.....###.###.#.#.....#...#.#...#.......#.#...#.#...#...#.....#...#...#.......#.....#...#...#.#...#...###.#.....#
#.###################.#.#.#.#.#######v###.#.#.#########.###.#.#######.#.#.#v#.###.#######.#.#######.###########.#####.###.###########.#.###.#
#.#...#...#...#...###...#.#.#.#.....>.>.#.#.#.........#...#.#.......#.#.#.>.>.###.....#...#...#.....#.....#.....#...#...#.#.......#...#.#...#
#.#.#.#.#.#.#.#.#.#######.#.#.#.#####v#.#.#.#########.###.#.#######.#.#.###v#########.#.#####.#.#####.###.#.#####.#.###.#.#.#####.#.###.#.###
#...#...#...#...#.......#.#.#.#.#.....#...#.#...#.....#...#.#.......#...###...#.....#...#...#.#.#.....###...#.....#.###...#.....#.#.....#...#
#######################.#.#.#.#.#.#########.#.#.#.#####.###.#.###############.#.###.#####.#.#.#.#.###########.#####.###########.#.#########.#
#...#.............#.....#...#.#.#...#.....#.#.#.#...#...#...#.........#.......#.#...#...#.#.#...#...........#.....#.###...#.....#...........#
#.#.#.###########.#.#########.#.###.#.###.#.#.#.###.#.###.###########.#.#######.#.###.#.#.#.###############.#####.#.###.#.#.#################
#.#...#.........#.#.......###...###...#...#...#.#...#...#.#...#...#...#.#...#...#.....#...#.#...............#.....#...#.#.#.#...#.....#.....#
#.#####.#######.#.#######.#############.#######.#.#####.#.#.#.#.#.#.###.#.#.#.#############.#.###############.#######.#.#.#.#.#.#.###.#.###.#
#.......#.......#.......#.....#.........#.....#...#####...#.#...#.#...#.#.#.#.#.......#.....#.#.............#.......#.#.#.#.#.#...#...#.#...#
#########.#############.#####.#.#########.###.#############.#####.###.#.#.#.#.#.#####.#.#####.#.###########.#######.#.#.#.#.#.#####.###.#.###
#.........#...###...###...#...#...#.....#.#...#...###.......#...#.....#...#.#.#.....#.#.....#...#...#.......#...###.#.#.#.#...#...#...#.#.###
#.#########.#.###.#.#####.#.#####.#.###.#.#.###.#.###.#######.#.###########.#.#####.#.#####.#####.#.#.#######.#.###.#.#.#.#####.#.###.#.#.###
#.....#.....#.....#.....#.#.#...#...###...#.....#.#...#.......#...#.......#...#.....#.......#.....#...#...###.#.#...#...#...#...#...#...#...#
#####.#.###############.#.#.#.#.#################.#.###.#########.#.#####.#####.#############.#########.#.###.#.#.#########.#.#####.#######.#
#.....#.#...#.......#...#...#.#...#.............#.#.....#.........#.#.....#...#.............#.....#...#.#.###.#.#.....#.....#.#.....#.......#
#.#####.#.#.#.#####.#.#######.###.#.###########.#.#######.#########.#.#####.#.#############.#####.#.#.#.#.###.#.#####.#.#####.#.#####v#######
#.......#.#...#####...#.....#.#...#.....#.....#...###...#...........#...#...#.....#.........###...#.#.#.#.#...#...#...#.#...#.#...#.>.#.....#
#########.#############.###.#.#.#######.#.###.#######.#.###############.#.#######.#.###########.###.#.#.#.#.#####.#.###.#.#.#.###.#.#v#.###.#
#.........#.....#...###...#...#.###...#...#...#...###.#.#...#.....#.....#.....#...#.#.....#...#.....#.#.#...#...#.#.#...#.#.#...#.#.#...#...#
#.#########.###.#.#.#####.#####.###.#.#####.###.#.###.#.#.#.#.###.#.#########.#.###.#.###.#.#.#######.#.#####.#.#.#.#.###.#.###.#.#.#####.###
#...........#...#.#.#...#.....#...#.#.#.....#...#.....#.#.#.#...#.#...#.......#.....#.#...#.#.###...#.#.......#.#...#...#.#.....#.#.###...###
#############.###.#.#.#.#####.###.#.#.#.#####.#########.#.#.###.#.###.#.#############.#.###.#.###.#.#.#########.#######.#.#######.#.###.#####
###...###.....#...#...#.#...#.#...#.#.#.....#.#.........#.#.....#.#...#...#.....#...#.#...#.#.#...#...#.......#.....#...#...#.....#...#...###
###.#.###.#####.#######.#.#.#.#.###.#.#####.#.#.#########.#######.#.#####.#.###.#.#.#.###.#.#.#.#######.#####.#####.#.#####.#.#######.###.###
#...#.....#...#...#.....#.#...#...#.#...#...#.#.#...#...#.......#...#...#...###...#.#.#...#.#.#.......#.....#.#...#.#.....#.#...#.....###...#
#.#########.#.###.#.#####.#######.#.###.#.###.#.#.#.#.#.#######v#####.#.###########.#.#.###.#.#######v#####.#.#.#.#.#####.#.###.#.#########.#
#.#...#...#.#...#.#.....#.#.......#...#.#...#.#.#.#.#.#.#...#.>.>.###.#.###...#...#.#.#...#.#.....#.>.>...#.#...#.#.#...#.#.#...#.###.......#
#.#.#.#.#.#.###.#.#####.#.#.#########.#.###v#.#.#.#.#.#.#.#.#.###.###.#.###.#.#.#.#v#.###.#.#####.#.#####.#.#####.#.#.#.#.#.#.###.###.#######
#.#.#.#.#.#...#.#.#.....#.#.#...#...#.#.#.>.>.#.#.#.#.#.#.#.#...#...#.#.#...#.#.#.>.>.#...#.#.....#.#.....#.....#.#.#.#...#.#...#...#...#...#
#.#.#.#.#.###.#.#.#.#####.#.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.###.###.#.#.#.###.#.#######.###.#.#####.#.#########.#.#.#.#####.###.###.###.#.#.#
#...#...#.....#...#.......#...#...#...#...#####...#...#...#.....###...#...###...#######.....#.......#...........#...#.......###.....###...#.#
###########################################################################################################################################.#""".split('\n')
data = [list(line) for line in data]

#####
start, end = (0, data[0].index('.')), (len(data) - 1, data[-1].index('.'))
DIRS = [(0, -1), (-1, 0), (0, 1), (1, 0)]
seen, idct, max_ = {}, '0', 0
queue = [(start, 0, idct)]
while queue:
    pos, count, id = queue.pop(0)
    if pos == end:
        max_ = max(max_, count)
        continue

    if pos not in seen:
        seen[pos] = []
    seen[pos].append(id)

    r, c = pos
    if data[r][c] in '<^>v':
        dr, dc = DIRS['<^>v'.index(data[r][c])]
        nr, nc = nr, nc = r + dr, c + dc
        if (nr, nc) in seen:
            seen_on_path = False
            for seen_id in seen[(nr, nc)]:
                if id.startswith(seen_id):
                    seen_on_path = True
                    break
            if seen_on_path:
                continue
        queue.append(((nr, nc), count + 1, id))
    else:
        valid_moves = []
        for i, d in enumerate(DIRS):
            dr, dc = d
            nr, nc = r + dr, c + dc
            
            # Check if we're looking at a path already been on
            if (nr, nc) in seen:
                seen_on_path = False
                for seen_id in seen[(nr, nc)]:
                    if id.startswith(seen_id):
                        seen_on_path = True
                        break
                if seen_on_path:
                    continue

            if not (0 <= nr < len(data) and 0 <= nc < len(data[0])) or data[nr][nc] == '#':
                continue
            if data[nr][nc] in '<^>v' and data[nr][nc] != '<^>v'[i]:
                continue

            valid_moves.append((nr, nc))
        choice = 0
        for nr, nc in valid_moves:
            nid = id if len(valid_moves) == 1 else id + str(choice)
            queue.append(((nr, nc), count + 1, nid))
            choice += 1
print(max_)

#####
graph = { start: {}, end: {} }
def get_valid_moves(seen, r, c):
    valid_moves = []
    for dr, dc in DIRS:
        nr, nc = r + dr, c + dc

        if (nr, nc) in seen or not (0 <= nr < len(data) and 0 <= nc < len(data[0])) or data[nr][nc] == '#':
            continue
        
        valid_moves.append((nr, nc))
    return valid_moves
def find_next_nodes(node):
    r, c = node
    seen = set()
    seen.add((r, c))
    valid_moves = get_valid_moves(seen, r, c)
    new_nodes = {}
    for nr, nc in valid_moves:
        seen.add((nr, nc))
        d = 1
        while len(moves := get_valid_moves(seen, nr, nc)) == 1:
            seen.add((nr, nc))
            d += 1
            nr, nc = moves[0]
        new_nodes[(nr, nc)] = d
    
    if node not in graph:
        graph[node] = {}
    
    for new_node, d in new_nodes.items():
        if new_node not in graph[node]:
            graph[node][new_node] = d
            find_next_nodes(new_node)
find_next_nodes(start)
dfs_seen = set()
max_sum = 0
def dfs(pos, sum_):
    global max_sum
    if pos == end:
        max_sum = max(max_sum, sum_)
        return
    if pos in dfs_seen:
        return
    dfs_seen.add(pos)
    neighbors = graph[pos]
    for neighbor, distance in neighbors.items():
        dfs(neighbor, sum_ + distance)
    dfs_seen.remove(pos)
dfs(start, 0)
print(max_sum)